<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="Example App | WebDriverIO Example" />
    <meta name="author" content="WebDriver.io" />
    <meta name="copyright" content="WebDriver.io, Inc" />

    <title>Webdriver.io: Kitchen Sink</title>

    <link rel="icon" href="/assets/img/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" href="/assets/css/vendor/bootstrap.min.css" />
    <link rel="stylesheet" href="/assets/css/vendor/fira.css" />
    <link rel="stylesheet" href="/assets/css/styles.css" />
  </head>

  <body>
    <nav class="navbar navbar-inverse">
      <div class="container">
        <div class="navbar-header">
          <button
            type="button"
            class="navbar-toggle collapsed"
            data-toggle="collapse"
            data-target="#navbar"
          >
            <span class="icon-bar"></span> <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">webdriver.io</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="active" class="dropdown">
              <a
                href="#"
                class="dropdown-toggle"
                data-toggle="dropdown"
                role="button"
                >Commands <span class="caret"></span
              ></a>
              <ul class="dropdown-menu">
                <li><a href="/commands/querying">Querying</a></li>
                <li><a href="/commands/traversal">Traversal</a></li>
                <li><a href="/commands/actions">Actions</a></li>
                <li><a href="/commands/window">Window</a></li>
                <li><a href="/commands/viewport">Viewport</a></li>
                <li><a href="/commands/location">Location</a></li>
                <li><a href="/commands/navigation">Navigation</a></li>
                <li class="active">
                  <a href="/commands/assertions">Assertions</a>
                </li>
                <li><a href="/commands/misc">Misc</a></li>
                <li><a href="/commands/connectors">Connectors</a></li>
                <li><a href="/commands/aliasing">Aliasing</a></li>
                <li><a href="/commands/waiting">Waiting</a></li>
                <li>
                  <a href="/commands/network-requests">Network Requests</a>
                </li>
                <li><a href="/commands/files">Files</a></li>
                <li><a href="/commands/storage">Storage</a></li>
                <li><a href="/commands/cookies">Cookies</a></li>
                <li>
                  <a href="/commands/spies-stubs-clocks"
                    >Spies, Stubs &amp; Clocks</a
                  >
                </li>
              </ul>
            </li>
            <li><a href="/utilities">Utilities</a></li>
            <li><a href="/webdriverio-api">Webdriver.io API</a></li>
          </ul>
          <ul class="nav navbar-nav pull-right">
            <li>
              <a
                href="https://github.com/webdriverio/webdriverio-example-kitchensink"
                >GitHub</a
              >
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <div class="banner">
      <div class="container">
        <h1>Assertions</h1>
        <p>
          Examples of asserting the state or behavior of your application in
          Webdriver.io, for a full reference of commands, go to
          <a href="https://webdriver.io/docs/api" target="_blank"
            >webdriver.io</a
          >
        </p>
      </div>
    </div>
    <div class="container content-container">
      <div id="assertions">
        <div class="row">
          <div class="col-xs-12">
            <h3>Implicit Assertions</h3>
            <hr />
          </div>

          <div class="col-xs-7">
            <h4 id="expect"><a href="https://webdriver.io/docs/api/expect" target="_blank">expect()</a></h4>
            <p>
              To make an assertion about an element or value, use the
              <a href="https://webdriver.io/docs/api/expect" target="_blank"><code>expect()</code></a>
              assertion library.
            </p>
            <pre><code class="javascript">const lastRow = await $('.assertion-table').$('tbody tr:last')
await expect(lastRow).toHaveClass('success')

const firstCell = await lastRow.$('td')

// checking the text of the <td> element
await expect(firstCell).toHaveText('Column content')
await expect(firstCell).toHaveTextContaining('Column content')

// to match text content against a regular expression
await expect(firstCell).toHaveText(/column content/i)

</code></pre>

            <p>Note: find even more examples of matching element's text content in this
              <a href="https://webdriver.io/app/faq#How-do-I-get-an-elements-text-contents" target="_blank">FAQ answer</a>.
            </p>
          </div>
          <div class="col-xs-5">
            <div class="well">
              <table class="table table-bordered assertion-table">
                <thead>
                  <tr>
                    <th>#</th>
                    <th>Column heading</th>
                    <th>Column heading</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th scope="row">1</th>
                    <td>Column content</td>
                    <td>Column content</td>
                  </tr>
                  <tr>
                    <th scope="row">2</th>
                    <td>Column content</td>
                    <td>Column content</td>
                  </tr>
                  <tr class="success">
                    <th scope="row">3</th>
                    <td>Column content</td>
                    <td>Column content</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

          <div class="col-xs-12"><hr /></div>

          <div class="col-xs-7">
            <h4 id="and"><a href="https://webdriver.io/docs/api/expect" target="_blank">Chaining Assertions</a></h4>
            <p>
              In Webdriver.io, you can chain multiple assertions on the same element.
            </p>
            <pre><code class="javascript">const link = await $('.assertions-link')
await expect(link).toHaveClass('active')
await expect(link).toHaveAttribute('href')
await expect(link).toHaveAttributeContaining('href', 'webdriver.io')</code></pre>
          </div>
          <div class="col-xs-5">
            <div class="well">
              <a class="assertions-link active" href="https://webdriver.io/docs/api/expect" target="_blank"
                >Webdriver.io Docs</a
              >
            </div>
          </div>

          <div class="col-xs-12"><hr /></div>

          <div class="col-xs-12">
            <h3>Explicit Assertions</h3>
            <hr />
          </div>

          <div class="col-xs-12">
            <h4 id="expect">expect</h4>
            <p>
              Webdriver.io comes with a built-in assertion library that uses
              <a href="https://webdriver.io/docs/api/expect" target="_blank"><code>expect</code></a
              >.
            </p>
          </div>

          <div class="col-xs-7">
            <pre><code class="javascript">expect(true).toBe(true)
const o = { foo: 'bar' }
expect(o).toBe(o)
expect(o).toEqual({ foo: 'bar' })
// matching text using regular expression
expect('FooBar').toMatch(/bar$/i)</code></pre>
          </div>

          <div class="col-xs-12"><hr /></div>

          <div class="col-xs-7">
            <h4 id="assert">Custom Assertions</h4>
            <p>
              You can write your own assertion functions for complex checks.
            </p>
            <pre><code class="javascript">const person = {
  name: 'Joe',
  age: 20,
}
expect(typeof person).toBe('object')</code></pre>
          </div>

          <div class="col-xs-12"><hr /></div>

          <div class="col-xs-12">
            <h3><a href="https://webdriver.io/docs/api/browser/waitUntil" target="_blank">waitUntil</a></h3>
            <hr />
          </div>

          <div class="col-xs-12">
            <p>
              For complex asynchronous assertions, you can use
              <a href="https://webdriver.io/docs/api/browser/waitUntil"><code>browser.waitUntil</code></a>.
              It will retry the condition until it returns true or times out.
            </p>
          </div>

          <div class="col-xs-7">
            <pre><code class="javascript">const pElements = await $$('.assertions-p p')

await browser.waitUntil(async () => {
  const texts = await Promise.all(pElements.map(p => p.getText()))
  return texts.length === 3 &&
         texts[0] === 'Some text from first p' &&
         texts[1] === 'More text from second p' &&
         texts[2] === 'And even more text from third p'
}, { timeoutMsg: 'Expected to find 3 paragraphs with specific text' })</code></pre>
          </div>
          <div class="col-xs-5">
            <div class="well">
              <div class="assertions-p">
                <p>Some text from first p</p>
                <p>More text from second p</p>
                <p>And even more text from third p</p>
              </div>
            </div>
          </div>

          <div class="col-xs-12">
            <p>Assert that element's class includes <code>heading-</code>.</p>
          </div>

          <div class="col-xs-7">
            <pre><code class="javascript">const div = await $('.docs-header').$('div')

await browser.waitUntil(async () => {
  const className = await div.getAttribute('class')
  return /heading-/.test(className)
}, { timeoutMsg: 'Expected div to have a class containing \'heading-\' ' })
  await expect(div).toHaveText('Introduction')</code></pre>
          </div>

          <div class="col-xs-5">
            <div class="well">
              <div class="docs-header">
                <div class="main-abc123 heading-xyz987">Introduction</div>
              </div>
            </div>
          </div>

          <div class="col-xs-12">
            <p>
              You can throw any error from the callback function. The callback
              will be retried, but the assertions will not be shown as nicely in
              the Command Log UI as Chai assertions.
            </p>
          </div>

          <div class="col-xs-7">
            <pre><code class="javascript">cy.get('.docs-header').find('div')
  .should(($div) => {
    if ($div.length !== 1) {
      // you can throw your own errors
      throw new Error('Did not find 1 element')
    }

    const className = $div[0].className

    if (!className.match(/heading-/)) {
      throw new Error(`Could not find class "heading-" in ${className}`)
    }
  })</code></pre>
          </div>

          <div class="col-xs-12">
            <p>
              We <a href="https://webdriver.io/docs/api">strongly recommend that your tests are deterministic</a>.
              But sometimes you might need to match text between two elements, and you
              do not know what that text should be. Save the value from the first element,
              then compare it from a <code>should(cb)</code> callback.
            </p>
          </div>

          <div class="col-xs-7">
            <pre><code class="javascript">let text
/**
* Normalizes passed text,
* useful before comparing text with spaces and different capitalization.
* @param {string} s Text to normalize
*/
const normalizeText = (s) => s.replace(/\s/g, '').toLowerCase()

cy.get('.two-elements')
.find('.first')
.then(($first) => {
  // save text from the first element
  text = normalizeText($first.text())
})

cy.get('.two-elements')
.find('.second')
.should(($div) => {
  // we can massage text before comparing
  const secondText = normalizeText($div.text())
  expect(secondText, 'second text').to.equal(text)
})</code></pre>
          </div>

          <div class="col-xs-5">
            <div class="well">
              <div class="two-elements">
                <div class="first">Foo Bar</div>
                <div class="second">foo b a r</div>
              </div>
            </div>
          </div>

          <div class="col-xs-12">
            <p>
              Remember that WebDriverIO only <a href="https://webdriver.io/docs/api">retries the very last command</a>,
              if it allows retrying. If you need to perform additional steps before running an assertion,
              you can use <code>.should(callbackFn)</code> to retry multiple operations.
            </p>
          </div>

          <div class="col-xs-7">
            <pre><code class="javascript">const randomNumberSpan = await $('#random-number')

await browser.waitUntil(async () => {
  const text = await randomNumberSpan.getText()
  const n = parseFloat(text)
  return !isNaN(n) && n >= 1 && n <= 10
}, { timeoutMsg: 'Expected random number to be between 1 and 10' })</code></pre>
</div>

          <div class="col-xs-5">
            <div class="well">
              <div class="random-number-example">
                Random number: <span id="random-number">üéÅ</span>
              </div>
              <script>
                const el = document.getElementById('random-number')
                setTimeout(() => {
                  el.innerText = Math.floor(Math.random() * 10 + 1)
                }, 1500)
              </script>
            </div>
          </div>

          <div class="col-xs-12"><hr /></div>
        </div>
      </div>
    </div>

    <script src="/assets/js/vendor/jquery-1.12.0.min.js"></script>
    <script src="/assets/js/vendor/bootstrap.min.js"></script>
    <script src="/assets/js/vendor/highlight.pack.js"></script>
    <script src="/assets/js/scripts.js"></script>
  </body>
</html>
